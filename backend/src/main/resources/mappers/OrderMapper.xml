<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.ssafitmall.model.dao.OrderDao">
    <!-- 전체 주문 조회 -->
    <select id="selectAllOrders" resultType="Order">
        SELECT * FROM orders
    </select>

    <!--    유저 주문 정보 리스트 조회-->
    <select id="searchByUserId" parameterType="String" resultType="Order">
        SELECT * FROM orders WHERE user_id = #{userId}
    </select>
    <!-- 주문 정보 하나 조회-->
    <select id="selectOrderById" parameterType="int" resultType="Order">
        SELECT
        *
        FROM
        Orders
        WHERE
        order_number = #{orderNumber};
    </select>
    <!--    주문 등록-->
    <insert id="createOrder" parameterType="order">

        <!--        주문 등록후 그 객체에 id값이 들어있도록 하기위한 쿼리-->
        <selectKey resultType="int" keyProperty="orderNumber" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>

        INSERT INTO orders ( receiver_name,receiver_phone ,recipient_address, user_id, product_code )
        VALUES
        (#{receiverName},#{receiverPhone},#{recipientAddress},#{userId}, #{productCode});
    </insert>

    <!--    주문 수정-->
    <update id="updateOrder" parameterType="order">
        UPDATE orders SET receiver_name = #{receiverName},receiver_phone = #{receiverPhone}, recipient_address =
        #{recipientAddress} WHERE order_number = #{orderNumber}
    </update>

    <!--    주문 삭제-->
    <delete id="deleteOrder" parameterType="int">
        DELETE FROM orders WHERE order_number = #{orderNumber}
    </delete>

    <!--     주문 상태 (현황 ) 수정 -->
    <update id="updateDeleveryStatus" parameterType="hashmap">
        UPDATE orders SET delivery_status = #{status} WHERE order_number = #{orderNumber}
    </update>

    <update id="updateDelevery" parameterType="hashmap">
        UPDATE orders SET is_delivered = #{status} WHERE order_number = #{orderNumber}
    </update>
</mapper>